<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Melody Fuse - Staff Schedule</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <nav>
        <div class="logo">
          <a href="./index.html">
            <img src="melodyfuselogo.png" alt="MelodyFuse Logo" />
          </a>
        </div>
        <ul class="nav-links">
          <li><a href="./index.html">Home</a></li>
          <li><a href="./about.html">About</a></li>
          <li><a href="./schedule.html">Schedule</a></li>
          <li><a href="./contact.html">Contact</a></li>
          <li><a href="https://discord.gg/5fXtmvzAxQ">Discord</a></li>
          <li><a href="./careers.html">Careers</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <section class="staff-schedule">
        <h2>Submit DJ Schedule</h2>
        <form id="schedule-form" class="schedule-form">
          <label for="date">Date:</label>
          <select id="date" name="date" required></select>

          <label for="time">Time:</label>
          <select id="time" name="time" required></select>

          <label for="dj-name">DJ Name:</label>
          <input type="text" id="dj-name" name="dj-name" required />

          <button type="submit" class="btn">SUBMIT</button>
        </form>
        <p id="response-message"></p>
      </section>
    </main>

    <footer class="footer">
      <p>
        &copy; 2024 MelodyFuse. All rights reserved.
        <a href="./privacy.html">Privacy Policy</a>
      </p>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // Fetch schedule data
        const response = await fetch("/.netlify/functions/get-schedule");
        const scheduleData = await response.json();

        const hours = [
          "00:00",
          "01:00",
          "02:00",
          "03:00",
          "04:00",
          "05:00",
          "06:00",
          "07:00",
          "08:00",
          "09:00",
          "10:00",
          "11:00",
          "12:00",
          "13:00",
          "14:00",
          "15:00",
          "16:00",
          "17:00",
          "18:00",
          "19:00",
          "20:00",
          "21:00",
          "22:00",
          "23:00",
        ]; // List of hours

        // Populate date dropdown
        const dateSelect = document.getElementById("date");
        Object.keys(scheduleData).forEach((date) => {
          const option = document.createElement("option");
          option.value = date;
          option.textContent = date;
          dateSelect.appendChild(option);
        });

        // Populate time dropdown
        const timeSelect = document.getElementById("time");
        hours.forEach((hour) => {
          const option = document.createElement("option");
          option.value = hour;
          option.textContent = hour;
          timeSelect.appendChild(option);
        });
      });

      document
        .getElementById("schedule-form")
        .addEventListener("submit", async (event) => {
          event.preventDefault();
          const date = document.getElementById("date").value;
          const time = document.getElementById("time").value;
          const djName = document.getElementById("dj-name").value;

          const response = await fetch("/.netlify/functions/update-schedule", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ date, time, djName }),
          });

          const result = await response.json();
          document.getElementById("response-message").textContent =
            result.message;
        });
    </script>
  </body>
</html>
